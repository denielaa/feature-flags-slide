import { CodeSurfer as Surfer } from "code-surfer";
import { vsDark } from "@code-surfer/themes"
import { Appear, Background } from "gatsby-theme-mdx-deck";
import customTheme from "../src/theme";
import * as L from "../src/layout";

export const theme = customTheme;

<L.Column sx={{ minHeight: '60%', ml: 5 }}>

# Feature Flags & Continuous Delivery

</L.Column>

---

<L.Column>

# Hi! 👋🏻 I'm **Deniel**

- A Mediocre Software Engineer
- 13 years of experience as a Software Engineer
- ~ 7 years experience working remotely
- Fullstack (BE heavy) -> Frontend

</L.Column>

---

import Release from '../assets/release.webp';

## Release a major new feature

<img src={Release} width="40%" />

---

import SystemError from '../assets/system-error.webp';

<img src={SystemError} width="80%" />

---

import UserError from '../assets/user-error.jpeg';

<img src={UserError} width="40%" />

---

<L.Column>

## Solutions

<ul>
  <li>Maintenance mode</li>
  <li>Rollback</li>
</ul>

### ...but a better option is _Feature Flags_

</L.Column>

---

<L.Column>

## We'll learn about...

- Definition of Feature Flags
- Benefits and Use Cases
- Trade-offs
- How to implement Feature Flags? _(Best Practices)_

### ...and how to _work remotely in Global Company_

</L.Column>

---

<Surfer theme={vsDark}>

```js title="Feature Flags"
if (featureFlags.isFeatureEnabled('newPaymentOption')) {
  RenderNewPaymentOption()
} else {
  RenderOldPaymentOption()
}
```

</Surfer>

---

<Surfer theme={vsDark}>

```js
import { CreditCardPayment } from './CreditCardPayment';
import { BitcoinPayment } from './BitcoinPayment';
import { NewPaymentOption } from './NewPaymentOption';

const PaymentOptions = () => {
  return (
    <div>
      <h3>Select payment option:</h3>
      <ul>
        <li><CreditCardPayment /></li>
        <li><BitcoinPayment /></li>
        <li><NewPaymentOption /></li>
      </ul>
    </div>
  );
};
```

```diff 3,12 title="Release a new payment option"
```

```js title="Hacky solution"
import { CreditCardPayment } from './CreditCardPayment';
import { BitcoinPayment } from './BitcoinPayment';
// import { NewPaymentOption } from './NewPaymentOption';

const PaymentOptions = () => {
  return (
    <div>
      <h3>Select payment option:</h3>
      <ul>
        <li><CreditCardPayment /></li>
        <li><BitcoinPayment /></li>
        // <li><NewPaymentOption /></li>
      </ul>
    </div>
  );
};
```

```js title="Release with Feature Flag"
import { CreditCardPayment } from './CreditCardPayment';
import { BitcoinPayment } from './BitcoinPayment';
import { NewPaymentOption } from './NewPaymentOption';
import { featureFlags } from './featureFlags';

const PaymentOptions = () => {
  return (
    <div>
      <h3>Select payment option:</h3>
      <ul>
        <li><CreditCardPayment /></li>
        <li><BitcoinPayment /></li>
        {featureFlags.isFeatureEnabled('newPaymentOption') &&
          <li><NewPaymentOption /></li>
        }
      </ul>
    </div>
  );
};
```

</Surfer>

---

import Switch from '../assets/switch.png';

## What are Feature Flags?

<img src={Switch} width="60%" />

---

## Why use Feature Flags?

- Release anytime, Deployment != Release
- Progressive Delivery
- User Segmentation/Targeting
- Kill Switch, Minimize Risk
- Blue/Green Deployment

---

<L.Column>

## Feature Flag use cases

### _Why is this simple if statement so powerful?_

</L.Column>

---

import ProductTesting from '../assets/product-testing.png';

### _Product Testing_

<img src={ProductTesting} width="50%" />

---

import ABTesting from '../assets/ab-testing.webp';

### _Conducting Experiments_

<img src={ABTesting} width="50%" />

---

import DBMigration1 from '../assets/db-migration-1.svg';

### _Database Migration_

<DBMigration1 />

---

import DBMigration2 from '../assets/db-migration-2.svg';

### _Database Migration_

<DBMigration2 />

---

import DBMigration3 from '../assets/db-migration-3.svg';

### _Database Migration_

<DBMigration3 />

---

import DBMigration4 from '../assets/db-migration-4.svg';

### _Database Migration_

<DBMigration4 />

---

import DBMigration5 from '../assets/db-migration-5.svg';

### _Database Migration_

<DBMigration5 />

---

import DBMigration6 from '../assets/db-migration-6.svg';

### _Database Migration_

<DBMigration6 />

---

import cd from '../assets/cd.png';

### _Continuous Delivery_

<img src={cd} width="80%" />

---

import Rollout from '../assets/gradually-rollout.png';

### _Rolling out features gradually_

<img src={Rollout} width="80%" />

---

<L.Column>

## Implementing a feature flag

- Homemade solution
- Use a Saas provider (LaunchDarkly, *Unleash*, etc)
- Ideally should be low latency, cached, have an audit trail

</L.Column>

---

import KnightCapital from '../assets/knight-capital.png';

<img src={KnightCapital} width="40%" />

---

import FTExplosion from '../assets/ft-explosion.jpg';

<L.Column>

## Trade-offs

- Increase complexity in the code
  - Reduced visibility, readability, and maintainability
- Technical debts
- Performance impact
- More code to *(maintain and test)*
- Combinatorial explosion

</L.Column>

<img src={FTExplosion} width="40%" />

---

<L.Column>

## Best Practices

- Include FFs as part of the *User Story planning*, *acceptance criteria*, and *Definition of Done*
- Standardize the naming convention
  - Clear and descriptive names
  - Consistent naming
  - Consistent prefix and suffix: `featureXxxEnabled`

</L.Column>

---

<L.Column>

## Best Practices (cont'd)

- Document the FFs with its purpose and parts of the application that are affected
- Creation/_Expiration_ dates
- Have a process to remove FFs
- _Never reuse FFs_, keep their surface area limited
- Collect and analyze FFs metrics on a regular basis

</L.Column>

---

<L.Column>

## Resources

- [Intentional Deployment: Best Practices for Feature Flag Management](https://www.youtube.com/watch?v=AD8LSdy7b2s)
- [Feature Toggles (aka Feature Flags)](https://martinfowler.com/articles/feature-toggles.html)
- [When (not) to use Feature Flags](https://www.qwan.eu/2021/02/01/feature-toggles.html)

</L.Column>

---

<Background />

## What's next?

- Try Feature Flags with simple library
- Research deeper into the Best Practices
- Check out Trunk Based Development

---

## I've worked at...

- Supercell Media (Australian Agency)
- Several overseas clients (Upwork, formerly oDesk)
- _Sunway Group_
- Maybank Malaysia
- Food Market Hub
- Alien Worlds (Biggest Blockchain Game)
- Clearview (US-based Agency)

---

## I've learned the importance of...

- **Communication** (language) is key
- Mindset of going global
- Team contribution, not only skills
- _LinkedIn_ and Github

---

<L.Column>

## How to use LinkedIn better?

- Don't ignore DMs from recruiters
- Get connected with related people (Recruiters, Hiring Managers, etc)
- Follow companies you're interested in
- Connect/Follow people you're interested in (CTO, HoE, SE)

</L.Column>

---

## More Questions?

- LinkedIn [denielaa](https://www.linkedin.com/in/denielaa/)

Slide deck is available at: 
[github.com/denielaa/feature-flags-slide/](https://github.com/denielaa/feature-flags-slide)
